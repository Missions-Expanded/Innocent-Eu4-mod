namespace = ME_Portugal_Events

country_event = {
	id = ME_Portugal_Events.1
	title = ME_Portugal_Events.1.t
	desc = ME_Portugal_Events.1.d
	picture = WIP_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Portugal_Events.1.a
		
		ai_chance = { factor = 9 }
		
		random_subject_country = {
			limit = {
				is_colonial_nation = yes
				capital_scope = { region = brazil_region }
				NOT = { liberty_desire = 30 }
			}
			grant_independence = yes
			
			#brazil_nation decision
			hidden_effect = {
				if = {
					limit = {
						NOT = { is_former_colonial_nation = yes }
					}
					ROOT = { save_event_target_as = old_tag_target }
				}
			}
			change_tag = BRZ
			if = {
				limit = {
					NOT = { is_former_colonial_nation = yes }
				}
				restore_old_nation_on_formation_effect = yes
				remove_non_electors_emperors_from_empire_effect = yes
			}
			if = {
				limit = {
					NOT = { government_rank = 2 }
				}
				set_government_rank = 2
			}
			if = {
				limit = {
					culture_group = iberian
					NOT = { primary_culture = brazilian }
				}
				change_primary_culture = brazilian
			}
			colonial_brazil = {
				limit = {
					NOT = { owned_by = ROOT }
				}
				add_permanent_claim = BRZ
			}
			add_country_modifier = {
				name = "centralization_modifier"
				duration = 7300
			}
			add_prestige = 25
			if = {
				limit = { has_custom_ideas = no }
				country_event = { id = ideagroups.1 } #Swap Ideas
			}
			set_country_flag = changed_from_colonial_nation
			
			ROOT = { create_union = PREV }
			add_country_modifier = {
				name = por_became_brazil
				duration = 9125 #25 years
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.1.b
		
		ai_chance = { factor = 1 }
		
		add_liberty_desire = 20
	}
}

#ME_Portugal_Events.2 skipped

#ME_Portugal_Events.3 skipped

country_event = {
	id = ME_Portugal_Events.4
	title = ME_Portugal_Events.4.t
	desc = ME_Portugal_Events.4.d
	picture = wip_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Portugal_Events.4.a
		
		custom_tooltip = ME_Portugal_Events.4.a.tt
		halve_estate_land_share = {
			estate = estate_nobles
		}
		every_owned_province = {
			limit = { is_core = ROOT }
			add_province_modifier = {
				name = por_seized_lands
				duration = 7300 #20 years
			}
		}
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -20
		}
	}
	
	option = {
		name = ME_Portugal_Events.4.b
		
		custom_tooltip = ME_Portugal_Events.4.b.tt
		hidden_effect = {
			set_variable = {
				which = por_counter
				value = 0
			}
			while = {
				limit = {
					NOT = {
						check_variable = {
							which = por_counter
							value = 15
						}
					}
				}
				every_owned_province = {
					limit = {
						is_core = ROOT
						ROOT = {
							NOT = {
								check_variable = {
									which = por_counter
									value = 15
								}
							}
						}
					}
					add_base_manpower = 1
					ROOT = {
						change_variable = {
							which = por_counter
							value = 1
						}
					}
				}
			}
		}
		add_country_modifier = {
			name = por_increased_levy
			duration = 7300 #20 years
		}
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -20
		}
	}
	
	option = {
		name = ME_Portugal_Events.4.c
		
		add_stability_or_adm_power = yes
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = 10
		}
	}
}

country_event = {
	id = ME_Portugal_Events.5
	title = ME_Portugal_Events.5.t
	desc = ME_Portugal_Events.5.d
	picture = wip_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		has_country_flag = por_sale_goa
		2030 = { has_discovered = ROOT }
	}
	
	option = {
		name = ME_Portugal_Events.5.a
		
		2030 = {
			owner = {
				country_event = {
					id = ME_Portugal_Events.6
					days = 0
				}
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.5.b
		
		add_country_modifier = {
			name = por_invasion_force
			duration = 1825 #5 years
		}
	}
}

country_event = {
	id = ME_Portugal_Events.6
	title = ME_Portugal_Events.6.t
	desc = ME_Portugal_Events.6.d
	picture = wip_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Portugal_Events.6.a
		
		2030 = { cede_province = FROM }
		add_country_modifier = {
			name = por_european_technology
			duration = 5475 #15 years
		}
	}
	
	option = {
		name = ME_Portugal_Events.6.b
		
		2030 = {
			if = {
				limit = {
					NOT = { is_permanent_claim = FROM }
					NOT = { is_core = FROM }
				}
				add_permanent_claim = FROM
			}
		}
	}
}

country_event = {
	id = ME_Portugal_Events.7
	title = ME_Portugal_Events.7.t
	desc = ME_Portugal_Events.7.d
	picture = wip_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Portugal_Events.7.a
		
		1020 = {
			owner = {
				country_event = { #Men from the West
					id = ME_Portugal_Events.8
					days = 0
				}
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.7.b
		
		#empty
	}
}

country_event = {
	id = ME_Portugal_Events.8
	title = ME_Portugal_Events.8.t
	desc = ME_Portugal_Events.8.d
	picture = wip_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Portugal_Events.8.a
		
		FROM = {
			country_event = { #The Lands Unlocked
				id = ME_Portugal_Events.9
				days = 0
			}
		}
		
		add_country_modifier = {
			name = por_western_weapons
			duration = 3650 #10 years
		}
	}
	
	option = {
		name = ME_Portugal_Events.8.b
		
		FROM = {
			country_event = { #The Mighty has declined
				id = ME_Portugal_Events.10
				days = 0
			}
		}
	}
}

country_event = {
	id = ME_Portugal_Events.9
	title = ME_Portugal_Events.9.t
	desc = ME_Portugal_Events.9.d
	picture = wip_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Portugal_Events.9.a
		
		1376 = { #nippon
			add_trade_modifier = {
				who = ROOT
				duration = -1 #wip
				power = 25
				key = por_lands_unlocked
			}
		}
	}
}

country_event = {
	id = ME_Portugal_Events.10
	title = ME_Portugal_Events.10.t
	desc = ME_Portugal_Events.10.d
	picture = wip_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Portugal_Events.10.a
		
		add_casus_belli = {
			target = FROM
			type = cb_trade_war_triggered
			months = 120 #wip
		}
	}
}

country_event = {
	id = ME_Portugal_Events.11
	title = ME_Portugal_Events.11.t
	desc = ME_Portugal_Events.11.d
	picture = wip_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			set_variable = {
				counter = 0
			}
			
			clr_country_flag = target1
			clr_country_flag = target2
			clr_country_flag = target3
			clr_country_flag = target4
			clr_country_flag = target5
			clr_country_flag = target6
			clr_country_flag = target7
			clr_country_flag = target8
			clr_country_flag = target9
			
			1020 = {
				owner = {
					every_subject_country = {
						limit = {
							has_reform = daimyo
						}
						
						capital_scope = {
							discover_country = ROOT
						}
						
						ROOT = {
							change_variable = {
								counter = 1
							}
							set_variable = {
								which = page
								which = counter
							}
							change_variable = {
								page = 8
							}
							divide_variable = {
								page = 9000
							}
							multiply_variable = {
								page = 1000
							}
						}
						set_variable = {
							which = page
							which = ROOT
						}
						ROOT = {
							set_variable = {
								which = max_page
								which = page
							}
							set_variable = {
								which = page
								which = current_page
							}
						}
						if = {
							limit = {
								is_variable_equal = {
									which = page
									which = ROOT
								}
							}
							ROOT = {
									 if = { limit = { NOT = { has_country_flag = target1 } } set_country_flag = target1 PREV = { save_event_target_as = target1 capital_scope = { save_event_target_as = target1c } } }
								else_if = { limit = { NOT = { has_country_flag = target2 } } set_country_flag = target2 PREV = { save_event_target_as = target2 capital_scope = { save_event_target_as = target2c } } }
								else_if = { limit = { NOT = { has_country_flag = target3 } } set_country_flag = target3 PREV = { save_event_target_as = target3 capital_scope = { save_event_target_as = target3c } } }
								else_if = { limit = { NOT = { has_country_flag = target4 } } set_country_flag = target4 PREV = { save_event_target_as = target4 capital_scope = { save_event_target_as = target4c } } }
								else_if = { limit = { NOT = { has_country_flag = target5 } } set_country_flag = target5 PREV = { save_event_target_as = target5 capital_scope = { save_event_target_as = target5c } } }
								else_if = { limit = { NOT = { has_country_flag = target6 } } set_country_flag = target6 PREV = { save_event_target_as = target6 capital_scope = { save_event_target_as = target6c } } }
								else_if = { limit = { NOT = { has_country_flag = target7 } } set_country_flag = target7 PREV = { save_event_target_as = target7 capital_scope = { save_event_target_as = target7c } } }
								else_if = { limit = { NOT = { has_country_flag = target8 } } set_country_flag = target8 PREV = { save_event_target_as = target8 capital_scope = { save_event_target_as = target8c } } }
								else_if = { limit = { NOT = { has_country_flag = target9 } } set_country_flag = target9 PREV = { save_event_target_as = target9 capital_scope = { save_event_target_as = target9c } } }
							}
						}
					}
				}
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.back
		highlight = yes
		
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = max_page
					value = 3
				}
			}
		}
		
		hidden_effect = {
			if = {
				limit = {
					is_variable_equal = {
						which = current_page
						value = 1
					}
				}
				set_variable = {
					which = current_page
					which = max_page
				}
			}
			else = {
				subtract_variable = {
					current_page = 1
				}
			}
			country_event = {
				id = ME_Portugal_Events.15
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.next
		highlight = yes
		
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = max_page
					value = 2
				}
			}
		}
		
		hidden_effect = {
			if = {
				limit = {
					is_variable_equal = {
						which = current_page
						which = max_page
					}
				}
				set_variable = {
					current_page = 1
				}
			}
			else = {
				change_variable = {
					current_page = 1
				}
			}
			country_event = {
				id = ME_Portugal_Events.15
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target1
		goto = target1c
		
		trigger = {
			has_country_flag = target1
		}
		
		capital_scope = {
			discover_country = event_target:target1
		}
		event_target:target1 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target2
		goto = target2c
		
		trigger = {
			has_country_flag = target2
		}
		
		capital_scope = {
			discover_country = event_target:target2
		}
		event_target:target2 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target3
		goto = target3c
		
		trigger = {
			has_country_flag = target3
		}
		
		capital_scope = {
			discover_country = event_target:target3
		}
		event_target:target3 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target4
		goto = target4c
		
		trigger = {
			has_country_flag = target4
		}
		
		capital_scope = {
			discover_country = event_target:target4
		}
		event_target:target4 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target5
		goto = target5c
		
		trigger = {
			has_country_flag = target5
		}
		
		capital_scope = {
			discover_country = event_target:target5
		}
		event_target:target5 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target6
		goto = target6c
		
		trigger = {
			has_country_flag = target6
		}
		
		capital_scope = {
			discover_country = event_target:target6
		}
		event_target:target6 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target7
		goto = target7c
		
		trigger = {
			has_country_flag = target7
		}
		
		capital_scope = {
			discover_country = event_target:target7
		}
		event_target:target7 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target8
		goto = target8c
		
		trigger = {
			has_country_flag = target8
		}
		
		capital_scope = {
			discover_country = event_target:target8
		}
		event_target:target8 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target9
		goto = target9c
		
		trigger = {
			has_country_flag = target9
		}
		
		capital_scope = {
			discover_country = event_target:target9
		}
		event_target:target9 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
}

country_event = {
	id = ME_Portugal_Events.15
	title = ME_Portugal_Events.11.t
	desc = ME_Portugal_Events.11.d
	picture = wip_eventPicture
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			set_variable = {
				counter = 0
			}
			
			clr_country_flag = target1
			clr_country_flag = target2
			clr_country_flag = target3
			clr_country_flag = target4
			clr_country_flag = target5
			clr_country_flag = target6
			clr_country_flag = target7
			clr_country_flag = target8
			clr_country_flag = target9
			
			1020 = {
				owner = {
					every_subject_country = {
						limit = {
							has_reform = daimyo
						}
						
						capital_scope = {
							discover_country = ROOT
						}
						
						ROOT = {
							change_variable = {
								counter = 1
							}
							set_variable = {
								which = page
								which = counter
							}
							change_variable = {
								page = 8
							}
							divide_variable = {
								page = 9000
							}
							multiply_variable = {
								page = 1000
							}
						}
						set_variable = {
							which = page
							which = ROOT
						}
						ROOT = {
							set_variable = {
								which = max_page
								which = page
							}
							set_variable = {
								which = page
								which = current_page
							}
						}
						if = {
							limit = {
								is_variable_equal = {
									which = page
									which = ROOT
								}
							}
							ROOT = {
									 if = { limit = { NOT = { has_country_flag = target1 } } set_country_flag = target1 PREV = { save_event_target_as = target1 capital_scope = { save_event_target_as = target1c } } }
								else_if = { limit = { NOT = { has_country_flag = target2 } } set_country_flag = target2 PREV = { save_event_target_as = target2 capital_scope = { save_event_target_as = target2c } } }
								else_if = { limit = { NOT = { has_country_flag = target3 } } set_country_flag = target3 PREV = { save_event_target_as = target3 capital_scope = { save_event_target_as = target3c } } }
								else_if = { limit = { NOT = { has_country_flag = target4 } } set_country_flag = target4 PREV = { save_event_target_as = target4 capital_scope = { save_event_target_as = target4c } } }
								else_if = { limit = { NOT = { has_country_flag = target5 } } set_country_flag = target5 PREV = { save_event_target_as = target5 capital_scope = { save_event_target_as = target5c } } }
								else_if = { limit = { NOT = { has_country_flag = target6 } } set_country_flag = target6 PREV = { save_event_target_as = target6 capital_scope = { save_event_target_as = target6c } } }
								else_if = { limit = { NOT = { has_country_flag = target7 } } set_country_flag = target7 PREV = { save_event_target_as = target7 capital_scope = { save_event_target_as = target7c } } }
								else_if = { limit = { NOT = { has_country_flag = target8 } } set_country_flag = target8 PREV = { save_event_target_as = target8 capital_scope = { save_event_target_as = target8c } } }
								else_if = { limit = { NOT = { has_country_flag = target9 } } set_country_flag = target9 PREV = { save_event_target_as = target9 capital_scope = { save_event_target_as = target9c } } }
							}
						}
					}
				}
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.back
		highlight = yes
		
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = max_page
					value = 3
				}
			}
		}
		
		hidden_effect = {
			if = {
				limit = {
					is_variable_equal = {
						which = current_page
						value = 1
					}
				}
				set_variable = {
					which = current_page
					which = max_page
				}
			}
			else = {
				subtract_variable = {
					current_page = 1
				}
			}
			country_event = {
				id = ME_Portugal_Events.11
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.next
		highlight = yes
		
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = max_page
					value = 2
				}
			}
		}
		
		hidden_effect = {
			if = {
				limit = {
					is_variable_equal = {
						which = current_page
						which = max_page
					}
				}
				set_variable = {
					current_page = 1
				}
			}
			else = {
				change_variable = {
					current_page = 1
				}
			}
			country_event = {
				id = ME_Portugal_Events.11
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target1
		goto = target1c
		
		trigger = {
			has_country_flag = target1
		}
		
		capital_scope = {
			discover_country = event_target:target1
		}
		event_target:target1 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target2
		goto = target2c
		
		trigger = {
			has_country_flag = target2
		}
		
		capital_scope = {
			discover_country = event_target:target2
		}
		event_target:target2 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target3
		goto = target3c
		
		trigger = {
			has_country_flag = target3
		}
		
		capital_scope = {
			discover_country = event_target:target3
		}
		event_target:target3 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target4
		goto = target4c
		
		trigger = {
			has_country_flag = target4
		}
		
		capital_scope = {
			discover_country = event_target:target4
		}
		event_target:target4 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target5
		goto = target5c
		
		trigger = {
			has_country_flag = target5
		}
		
		capital_scope = {
			discover_country = event_target:target5
		}
		event_target:target5 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target6
		goto = target6c
		
		trigger = {
			has_country_flag = target6
		}
		
		capital_scope = {
			discover_country = event_target:target6
		}
		event_target:target6 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target7
		goto = target7c
		
		trigger = {
			has_country_flag = target7
		}
		
		capital_scope = {
			discover_country = event_target:target7
		}
		event_target:target7 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target8
		goto = target8c
		
		trigger = {
			has_country_flag = target8
		}
		
		capital_scope = {
			discover_country = event_target:target8
		}
		event_target:target8 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.11.target9
		goto = target9c
		
		trigger = {
			has_country_flag = target9
		}
		
		capital_scope = {
			discover_country = event_target:target9
		}
		event_target:target9 = {
			country_event = {
				id = ME_Portugal_Events.12
				days = 0
			}
		}
	}
}

country_event = {
	id = ME_Portugal_Events.12
	title = ME_Portugal_Events.12.t
	desc = ME_Portugal_Events.12.d
	picture = wip_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Portugal_Events.12.a
		
		add_country_modifier = {
			name = por_western_weapons
			duration = 3650 #10 years
		}
		
		FROM = {
			country_event = { #Bussines is Bussines
				id = ME_Portugal_Events.13
				days = 0
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.12.b
		
		add_estate_loyalty = {
			estate = estate_burghers
			loyalty = 10
		}
		
		FROM = {
			country_event = { #Plan failed
				id = ME_Portugal_Events.14
				days = 0
			}
		}
	}
}

country_event = {
	id = ME_Portugal_Events.13
	title = ME_Portugal_Events.13.t
	desc = ME_Portugal_Events.13.d
	picture = wip_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Portugal_Events.13.a
		
		1376 = { #nippon
			add_trade_modifier = {
				who = ROOT
				duration = -1 #wip
				power = 10
				key = por_bussines_bussines
			}
		}
	}
}

country_event = {
	id = ME_Portugal_Events.14
	title = ME_Portugal_Events.14.t
	desc = ME_Portugal_Events.14.d
	picture = wip_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Portugal_Events.14.a
		
		add_casus_belli = {
			target = FROM
			type = cb_trade_war_triggered
			months = 120 #wip
		}
	}
}

#ME_Portugal_Events.15 found below ME_Portugal_Events.11

country_event = {
	id = ME_Portugal_Events.16
	title = ME_Portugal_Events.16.t
	desc = ME_Portugal_Events.16.d
	picture = wip_eventPicture
	
	mean_time_to_happen = {
		months = 60
	}
	
	trigger = {
		tag = POR
		is_year = 1470
		has_idea = quest_for_the_new_world
		NOT = { is_at_war = yes }
		OR = {
			num_of_heavy_ship = 5
			has_flagship = yes
		}
		current_age = age_of_discovery
	}
	
	option = {
		name = ME_Portugal_Events.16.a
		
		add_years_of_income = -0.5
		set_country_flag = por_escola_sagres
		tooltip = {
			add_country_modifier = {
				name = por_escola_sagres
				duration = -1
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.16.a
		
		add_prestige = 5
	}
}

country_event = {
	id = ME_Portugal_Events.17
	title = ME_Portugal_Events.17.t
	desc = ME_Portugal_Events.17.d
	picture = wip_eventPicture
	
	trigger = {
		tag = POR
		has_idea = quest_for_the_new_world
		OR = {
			AND = {
				ENG = {
					has_idea = quest_for_the_new_world
					alliance_with = ROOT
					trust = {
						who = ROOT
						value = 60
					}
				}
				trust = {
					who = ENG
					value = 60
				}
			}
			AND = {
				GBR = {
					has_idea = quest_for_the_new_world
					alliance_with = GBR
					trust = {
						who = ROOT
						value = 60
					}
				}
				trust = {
					who = GBR
					value = 60
				}
			}
		}
		OR = {
			current_age = age_of_discovery
			current_age = age_of_reformation
		}
	}
	
	immediate = {
		if = {
			limit = {
				ENG = {
					has_idea = quest_for_the_new_world
					alliance_with = ROOT
					trust = {
						who = ROOT
						value = 60
					}
				}
				trust = {
					who = ENG
					value = 60
				}
			}
			ENG = {
				country_event = {
					id = ME_Portugal_Events.18
					days = 0
				}
			}
		}
		else = {
			GBR = {
				country_event = {
					id = ME_Portugal_Events.18
					days = 0
				}
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.17.a
		
		set_country_flag = por_anglo_company
		tooltip = {
			add_country_modifier = {
				name = por_anglo_company
				duration = -1
			}
		}
		custom_tooltip = desc_por_anglo_company_triggered_modifier
	}
}

country_event = {
	id = ME_Portugal_Events.18
	title = ME_Portugal_Events.18.t
	desc = ME_Portugal_Events.18.d
	picture = wip_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Portugal_Events.18.a
		
		set_country_flag = por_anglo_company
		tooltip = {
			add_country_modifier = {
				name = por_anglo_company
				duration = -1
			}
		}
		custom_tooltip = desc_por_anglo_company_triggered_modifier
	}
}

country_event = {
	id = ME_Portugal_Events.19
	title = ME_Portugal_Events.19.t
	desc = ME_Portugal_Events.19.d
	picture = wip_eventPicture
	
	hidden = yes
	
	trigger = {
		OR = {
			AND = {
				NOT = { has_country_modifier = por_anglo_company_triggered_modifier }
				NOT = {
					is_variable_equal = {
						which = por_colony_count
						value = 0
					}
				}
			}
			AND = {
				has_country_modifier = por_anglo_company_triggered_modifier
				any_ally = {
					has_country_flag = por_anglo_company
					if = { limit = { colony = 8 }
						if = { limit = { colony = 12 }
							ROOT = { NOT = { is_variable_equal = { which = por_colony_count value = 12 } } }
						}
						else = {
							if = { limit = { colony = 10 }
								if = { limit = { colony = 11 }
									ROOT = { NOT = { is_variable_equal = { which = por_colony_count value = 11 } } }
								}
								else = {
									ROOT = { NOT = { is_variable_equal = { which = por_colony_count value = 10 } } }
								}
							}
							else = {
								if = { limit = { colony = 9 }
									ROOT = { NOT = { is_variable_equal = { which = por_colony_count value = 9 } } }
								}
								else = {
									ROOT = { NOT = { is_variable_equal = { which = por_colony_count value = 8 } } }
								}
							}
						}
					}
					else = {
						if = { limit = { colony = 4 }
							if = { limit = { colony = 6 }
								if = { limit = { colony = 7 }
									ROOT = { NOT = { is_variable_equal = { which = por_colony_count value = 7 } } }
								}
								else = {
									ROOT = { NOT = { is_variable_equal = { which = por_colony_count value = 6 } } }
								}
							}
							else = {
								if = { limit = { colony = 5 }
									ROOT = { NOT = { is_variable_equal = { which = por_colony_count value = 5 } } }
								}
								else = {
									ROOT = { NOT = { is_variable_equal = { which = por_colony_count value = 4 } } }
								}
							}
						}
						else = {
							if = { limit = { colony = 2 }
								if = { limit = { colony = 3 }
									ROOT = { NOT = { is_variable_equal = { which = por_colony_count value = 3 } } }
								}
								else = {
									ROOT = { NOT = { is_variable_equal = { which = por_colony_count value = 2 } } }
								}
							}
							else = {
								if = { limit = { colony = 1 }
									ROOT = { NOT = { is_variable_equal = { which = por_colony_count value = 1 } } }
								}
								else = {
									ROOT = { NOT = { is_variable_equal = { which = por_colony_count value = 0 } } }
								}
							}
						}
					}
				}
			}
		}
	}
	
	immediate = {
		if = {
			limit = {
				NOT = { has_country_modifier = por_anglo_company_triggered_modifier }
			}
			set_variable = {
				which = por_colony_count
				value = 0
			}
		}
		else = {
			random_ally = {
				limit = {
					has_country_flag = por_anglo_company
				}
				if = { limit = { colony = 8 }
					if = { limit = { colony = 12 }
						ROOT = { set_variable = { which = por_colony_count value = 12 } }
					}
					else = {
						if = { limit = { colony = 10 }
							if = { limit = { colony = 11 }
								ROOT = { set_variable = { which = por_colony_count value = 11 } }
							}
							else = {
								ROOT = { set_variable = { which = por_colony_count value = 10 } }
							}
						}
						else = {
							if = { limit = { colony = 9 }
								ROOT = { set_variable = { which = por_colony_count value = 9 } }
							}
							else = {
								ROOT = { set_variable = { which = por_colony_count value = 8 } }
							}
						}
					}
				}
				else = {
					if = { limit = { colony = 4 }
						if = { limit = { colony = 6 }
							if = { limit = { colony = 7 }
								ROOT = { set_variable = { which = por_colony_count value = 7 } }
							}
							else = {
								ROOT = { set_variable = { which = por_colony_count value = 6 } }
							}
						}
						else = {
							if = { limit = { colony = 5 }
								ROOT = { set_variable = { which = por_colony_count value = 5 } }
							}
							else = {
								ROOT = { set_variable = { which = por_colony_count value = 4 } }
							}
						}
					}
					else = {
						if = { limit = { colony = 2 }
							if = { limit = { colony = 3 }
								ROOT = { set_variable = { which = por_colony_count value = 3 } }
							}
							else = {
								ROOT = { set_variable = { which = por_colony_count value = 2 } }
							}
						}
						else = {
							if = { limit = { colony = 1 }
								ROOT = { set_variable = { which = por_colony_count value = 1 } }
							}
							else = {
								ROOT = { set_variable = { which = por_colony_count value = 0 } }
							}
						}
					}
				}
			}
		}
		
		if = {
			limit = {
				NOT = {
					check_variable = {
						which = por_colony_count
						value = 2
					}
				}
			}
			set_variable = {
				which = por_colony_count_var
				value = 0
			}
		}
		else = {
			set_variable = {
				which = por_colony_count_var
				which = por_colony_count
			}
			subtract_variable = {
				which = por_colony_count_var
				value = 1
			}
		}
		
		por_colony_count_update_mod = {
			mod = por_colony_count
			var = por_colony_count_var
			scope = country
		}
		
		log = "[This.GetName] por_colony_count [This.por_colony_count.GetValue]"
	}
	
	option = {
		#
	}
}

country_event = {
	id = ME_Portugal_Events.20
	title = ME_Portugal_Events.20.t
	desc = ME_Portugal_Events.20.d
	picture = wip_eventPicture
	
	mean_time_to_happen = {
		months = 24
	}
	
	trigger = {
		religion = catholic
		num_of_cardinals = 3
		OR = {
			papal_influence = 25
			is_papal_controller = yes
		}
		NOT = { is_at_war = yes }
		343 = {
			owner = {
				NOT = { religion_group = christian }
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.20.a
		
		343 = {
			owner = { save_global_event_target_as = por_crusade_target }
		}
		
		set_country_flag = por_crusade_partner
		
		PAP = {
			country_event = { #An Emmisary from the Portugese
				id = ME_Portugal_Events.21
				days = 0
				tooltip = ME_Portugal_Events.20.a.tt
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.20.b
		
		ai_chance = { factor = 0 }
		
		add_estate_loyalty = {
			estate = estate_church
			loyalty = -10
		}
	}
}

country_event = {
	id = ME_Portugal_Events.21
	title = ME_Portugal_Events.21.t
	desc = ME_Portugal_Events.21.d
	picture = wip_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Portugal_Events.21.a
		
		FROM = {
			country_event = { #A divine day
				id = ME_Portugal_Events.22
				days = 0
			}
		}
		every_known_country = {
			limit = {
				capital_scope = { region = iberia_region }
				NOT = { tag = FROM }
				religion = catholic
			}
			country_event = { #An upcoming Crusade
				id = ME_Portugal_Events.23
				days = 0
			}
		}
		
		add_opinion = {
			who = FROM
			modifier = por_blessed_efforts
		}
		reverse_add_opinion = {
			who = FROM
			modifier = por_blessed_efforts
		}
	}
	
	option = {
		name = ME_Portugal_Events.21.b
		
		ai_chance = { factor = 0 }
		
		reverse_add_opinion = {
			who = FROM
			modifier = por_rejected_offer
		}
	}
}

country_event = {
	id = ME_Portugal_Events.22
	title = ME_Portugal_Events.22.t
	desc = ME_Portugal_Events.22.d
	picture = wip_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Portugal_Events.22.a
		
		custom_tooltip = ME_Portugal_Events.22.a.tt
		set_country_flag = por_crusade_partner
		add_casus_belli = {
			target = event_target:por_crusade_target
			type = cb_vassalize_mission
			months = 120 #wip
		}
		
		#wip
		#[All nations in a war with Portugal against portugal_crusade_target gain a bonus similar to the crusade ones.]
		#[Once the war is declared, every nation that picked option 3 in "An upcoming Crusade" will join in the war if Portugal is only at war with portugal_crusade_target and its allies]
		#[Once declared and in the war, the nations will get the ducats from the curia treasury.]		
		#[Portugal and all of the other participants will get 100 ducats substracted from the curia treasury]
		#[If spain joins, spain will get 300 ducats]
	}
}

country_event = {
	id = ME_Portugal_Events.23
	title = ME_Portugal_Events.23.t
	desc = ME_Portugal_Events.23.d
	picture = wip_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Portugal_Events.23.a
		
		trigger = { manpower = 1 }
		
		if = {
			limit = { manpower = 5 }
			add_manpower = -5
			POR = { add_manpower = 5 }
			add_papal_influence = 5
		}
		else_if = {
			limit = { manpower = 4 }
			add_manpower = -4
			POR = { add_manpower = 4 }
			add_papal_influence = 4
		}
		else_if = {
			limit = { manpower = 3 }
			add_manpower = -3
			POR = { add_manpower = 3 }
			add_papal_influence = 3
		}
		else_if = {
			limit = { manpower = 2 }
			add_manpower = -2
			POR = { add_manpower = 2 }
			add_papal_influence = 2
		}
		else_if = {
			limit = { manpower = 1 }
			add_manpower = -1
			POR = { add_manpower = 1 }
			add_papal_influence = 1
		}
		else = {
			custom_tooltip = ME_Portugal_Events.23.e
			add_prestige = -5
		}
	}
	
	option = {
		name = ME_Portugal_Events.23.b
		
		add_treasury = -300
		POR = { add_treasury = 300 }
		add_papal_influence = 5
	}
	
	option = {
		name = ME_Portugal_Events.23.c
		
		ai_chance = { factor = 25 }
		
		trigger = {
			event_target:por_crusade_target = {
				if = {
					limit = { has_dlc = "Rights of Man" }
					any_ally = {
						is_great_power = yes
					}
				}
				else = {
					OR = {
						alliance_with = MAM
						alliance_with = TUR
					}
				}
			}
		}
		
		custom_tooltip = ME_Portugal_Events.23.c.tt
		set_country_flag = por_crusade_partner
		add_papal_influence = 10
	}
	
	option = {
		name = ME_Portugal_Events.23.e
		
		add_prestige = -5
	}
}

country_event = {
	id = ME_Portugal_Events.24
	title = ME_Portugal_Events.24.t
	desc = ME_Portugal_Events.24.d
	picture = wip_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Portugal_Events.24.a
		
		join_all_offensive_wars_of = FROM
		
		#wip
		#[Root gets 5% of the ducats in the curia treasury ]
	}
	
	option = {
		name = ME_Portugal_Events.24.b
		
		ai_chance = { factor = 0 }
		
		add_stability = -3
	}
}

country_event = {
	id = ME_Portugal_Events.25
	title = ME_Portugal_Events.25.t
	desc = ME_Portugal_Events.25.d
	picture = wip_eventPicture
	
	trigger = {
		tag = POR
		NOT = { is_at_war = yes }
		343 = {
			owner = { is_subject_of = ROOT }
		}
		religion_group = christian
	}
	
	option = {
		name = ME_Portugal_Events.25.a
		
		343 = {
			owner = {
				every_owned_province = {
					limit = { has_port = yes }
					cede_province = ROOT
				}
				
				define_ruler = {
					name = "Abu Abdallah Mohammed"
					dynasty = "Saadi"
					adm = 6
					dip = 3
					mil = 4
				}
				
				add_liberty_desire = -20
			}
		}
	}
	
	option = {
		name = ME_Portugal_Events.25.b
		ai_chance = { factor = 0 }
		
		add_stability_or_adm_power = yes
		add_dip_power = 150
	}
}
