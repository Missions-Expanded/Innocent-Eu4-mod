namespace = Melva_Persia_Events

#Rise of Ismail
country_event = {
	id = Melva_Persia_Events.1
	title = Melva_Persia_Events.1.T
	desc = Melva_Persia_Events.1.D
	picture = GENERALS_DISCUSSING_eventPicture

	fire_only_once = yes

	trigger = {
		is_year = 1500
		NOT = { has_global_flag = persia_ismail_has_risen }
		owns = 424
	}

	mean_time_to_happen = {
		months = 6
	}

	goto = 424

	option = {
		name = Melva_Persia_Events.1.OPT1

		set_country_flag = melva_persia_ismail
		add_legitimacy = -25
		add_prestige = -15
		define_ruler = {
			name = "Ismâ'îl I"
			dynasty = "Safavid"
			age = 15
			adm = 6
			dip = 5
			mil = 5
			religion = shiite
			culture = azerbaijani
			attach_leader = "Ismâ'îl I"
		}
		add_ruler_modifier = {
			name = melva_persia_ismail_legitimacy
			duration = 3650
			desc = MELVA_PERSIA_ISMAIL_CONQUEST_TT
		}
		#custom_tooltip = MELVA_PERSIA_ISMAIL_CONQUEST_TT
		shirvan_area = {
			limit = {
				NOT = { owned_by = ROOT }
				NOT = { is_core = ROOT }
				NOT = { is_empty = yes }
			}
			add_permanent_claim = ROOT
		}
		erzurum_area = {
			limit = {
				NOT = { owned_by = ROOT }
				NOT = { is_core = ROOT }
				NOT = { is_empty = yes }
			}
			add_permanent_claim = ROOT
		}
		tabriz_area = {
			limit = {
				NOT = { owned_by = ROOT }
				NOT = { is_core = ROOT }
				NOT = { is_empty = yes }
			}
			add_permanent_claim = ROOT
		}
		kartli_kakheti_area = {
			limit = {
				NOT = { owned_by = ROOT }
				NOT = { is_core = ROOT }
				NOT = { is_empty = yes }
			}
			add_permanent_claim = ROOT
		}
		imereti_area = {
			limit = {
				NOT = { owned_by = ROOT }
				NOT = { is_core = ROOT }
				NOT = { is_empty = yes }
			}
			add_permanent_claim = ROOT
		}
	}

	option = {
		name = Melva_Persia_Events.1.OPT2

		add_stability_or_adm_power = yes
		424 = {
			spawn_rebels = {
				size = 2
				leader = "Ismâ'îl I"
				leader_dynasty = "Safavid"
				win = yes
			}
		}
	}
}

#Securing of Shirvan
country_event = {
	id = Melva_Persia_Events.2
	title = Melva_Persia_Events.2.T
	desc = Melva_Persia_Events.2.D
	picture = GOOD_WITH_MONARCH_eventPicture

	fire_only_once = yes

	trigger = {
		has_country_flag = melva_persia_ismail
		shirvan_area = {
			type = all
			owned_by = ROOT
		}
	}

	mean_time_to_happen = {
		days = 60
	}

	option = {
		name = Melva_Persia_Events.2.OPT1

		add_yearly_manpower = 0.5
		add_mil_power = 25
		if = {
			limit = { has_ruler_modifier = melva_persia_ismail_legitimacy_1_1 }
			remove_country_modifier = melva_persia_ismail_legitimacy_1_1
			add_ruler_modifier = {
				name = melva_persia_ismail_legitimacy_1_2
				duration = 3650
			}
		}
		else_if = {
			limit = { has_ruler_modifier = melva_persia_ismail_legitimacy_1 }
			remove_country_modifier = melva_persia_ismail_legitimacy_1
			add_ruler_modifier = {
				name = melva_persia_ismail_legitimacy_1_1
				duration = 3650
			}
		}
		else_if = {
			limit = { has_ruler_modifier = melva_persia_ismail_legitimacy }
			remove_country_modifier = melva_persia_ismail_legitimacy
			add_ruler_modifier = {
				name = melva_persia_ismail_legitimacy_1
				duration = 3650
			}
		}
	}
}

#Iranian Armenia 
country_event = {
	id = Melva_Persia_Events.3
	title = Melva_Persia_Events.3.T
	desc = Melva_Persia_Events.3.D
	picture = CARAVAN_EVENT_Picture

	fire_only_once = yes

	trigger = {
		has_country_flag = melva_persia_ismail
		armenia_area = {
			type = all
			owned_by = ROOT
		}
	}

	mean_time_to_happen = {
		days = 60
	}

	option = {
		name = Melva_Persia_Events.3.OPT1

		add_adm_power = 25
		if = {
			limit = { has_ruler_modifier = melva_persia_ismail_legitimacy_1_1 }
			remove_country_modifier = melva_persia_ismail_legitimacy_1_1
			add_ruler_modifier = {
				name = melva_persia_ismail_legitimacy_1_2
				duration = 3650
			}
		}
		else_if = {
			limit = { has_ruler_modifier = melva_persia_ismail_legitimacy_1 }
			remove_country_modifier = melva_persia_ismail_legitimacy_1
			add_ruler_modifier = {
				name = melva_persia_ismail_legitimacy_1_1
				duration = 3650
			}
		}
		else_if = {
			limit = { has_ruler_modifier = melva_persia_ismail_legitimacy }
			remove_country_modifier = melva_persia_ismail_legitimacy
			add_ruler_modifier = {
				name = melva_persia_ismail_legitimacy_1
				duration = 3650
			}
		}

		419 = {
			add_base_tax = 2
		}
	}
}

#Safavid Georgia
country_event = {
	id = Melva_Persia_Events.4
	title = Melva_Persia_Events.4.T
	desc = Melva_Persia_Events.4.D
	picture = GOOD_WITH_MONARCH_eventPicture

	fire_only_once = yes

	trigger = {
		has_country_flag = melva_persia_ismail
		kartli_kakheti_area = {
			type = all
			owned_by = ROOT
		}
		imereti_area = {
			type = all
			owned_by = ROOT
		}
	}

	mean_time_to_happen = {
		days = 60
	}

	option = {
		name = Melva_Persia_Events.4.OPT1

		add_dip_power = 25
		if = {
			limit = { has_ruler_modifier = melva_persia_ismail_legitimacy_1_1 }
			remove_country_modifier = melva_persia_ismail_legitimacy_1_1
			add_ruler_modifier = {
				name = melva_persia_ismail_legitimacy_1_2
				duration = 3650
			}
		}
		else_if = {
			limit = { has_ruler_modifier = melva_persia_ismail_legitimacy_1 }
			remove_country_modifier = melva_persia_ismail_legitimacy_1
			add_ruler_modifier = {
				name = melva_persia_ismail_legitimacy_1_1
				duration = 3650
			}
		}
		else_if = {
			limit = { has_ruler_modifier = melva_persia_ismail_legitimacy }
			remove_country_modifier = melva_persia_ismail_legitimacy
			add_ruler_modifier = {
				name = melva_persia_ismail_legitimacy_1
				duration = 3650
			}
		}

		4301 = { add_base_production = 2 }
		422 = { add_base_production = 2 }
	}
}

#Conquest of Trebizond
country_event = {
	id = Melva_Persia_Events.5
	title = Melva_Persia_Events.5.T
	desc = Melva_Persia_Events.5.D
	picture = GOOD_WITH_MONARCH_eventPicture

	fire_only_once = yes

	trigger = {
		has_country_flag = melva_persia_ismail
		erzurum_area = {
			type = all
			owned_by = ROOT
		}
	}

	mean_time_to_happen = {
		days = 60
	}

	option = {
		name = Melva_Persia_Events.5.OPT1

		add_legitimacy_equivalent = { value = 5 republican_tradition = 3 }
		if = {
			limit = {
				OR = {
					has_ruler_modifier = melva_persia_ismail_legitimacy
					has_ruler_modifier = melva_persia_ismail_legitimacy_1
					has_ruler_modifier = melva_persia_ismail_legitimacy_1_1
					has_ruler_modifier = melva_persia_ismail_legitimacy_1_2
				}
			}
			remove_country_modifier = melva_persia_ismail_legitimacy_1_2
			add_ruler_modifier = {
				name = melva_persia_ismail_legitimacy_2
				duration = 3650
			}
		}
		else_if = {
			limit = { has_ruler_modifier = melva_persia_ismail_legitimacy_2 }
			remove_country_modifier = melva_persia_ismail_legitimacy_2
			add_ruler_modifier = {
				name = melva_persia_ismail_legitimacy_2_1
				duration = 3650
			}
		}
	}
}

#Victory over AQQ
country_event = {
	id = Melva_Persia_Events.6
	title = Melva_Persia_Events.6.T
	desc = Melva_Persia_Events.6.D
	picture = GOOD_WITH_MONARCH_eventPicture

	fire_only_once = yes

	trigger = {
		has_country_flag = melva_persia_ismail
		is_in_war = {
			attacker_leader = ROOT
			defender_leader = AKK
			war_score = 50
		}
	}

	mean_time_to_happen = {
		days = 60
	}

	option = {
		name = Melva_Persia_Events.6.OPT1

		add_mil_power = 25
		if = {
			limit = {
				OR = {
					has_ruler_modifier = melva_persia_ismail_legitimacy
					has_ruler_modifier = melva_persia_ismail_legitimacy_1
					has_ruler_modifier = melva_persia_ismail_legitimacy_1_1
					has_ruler_modifier = melva_persia_ismail_legitimacy_1_2
				}
			}
			remove_country_modifier = melva_persia_ismail_legitimacy
			remove_country_modifier = melva_persia_ismail_legitimacy_1
			remove_country_modifier = melva_persia_ismail_legitimacy_1_1
			remove_country_modifier = melva_persia_ismail_legitimacy_1_2
			add_ruler_modifier = {
				name = melva_persia_ismail_legitimacy_2
				duration = 3650
			}
		}
		else_if = {
			limit = { has_ruler_modifier = melva_persia_ismail_legitimacy_2 }
			remove_country_modifier = melva_persia_ismail_legitimacy_2
			add_ruler_modifier = {
				name = melva_persia_ismail_legitimacy_2_1
				duration = 3650
			}
		}
	}
}

#A new Shah
country_event = {
	id = Melva_Persia_Events.7
	title = Melva_Persia_Events.7.T
	desc = Melva_Persia_Events.7.D
	picture = GOOD_WITH_MONARCH_eventPicture

	fire_only_once = yes

	trigger = {
		has_country_flag = melva_persia_ismail
		owns_core_province = 416
		is_at_war = no
	}

	mean_time_to_happen = {
		days = 60
	}

	goto = 416

	option = {
		name = Melva_Persia_Events.6.OPT1

		add_stability_or_adm_power = yes
		add_prestige_or_monarch_power = { amount = 15 }
		if = {
			limit = {
				OR = {
					has_ruler_modifier = melva_persia_ismail_legitimacy_2
					has_ruler_modifier = melva_persia_ismail_legitimacy_2_1
				}
			}
			remove_country_modifier = melva_persia_ismail_legitimacy_2
			remove_country_modifier = melva_persia_ismail_legitimacy_2_1
			add_ruler_modifier = {
				name = melva_persia_ismail_legitimacy_3
				duration = 3650
			}
		}
	}
}

#
#country_event = {
#	id = Melva_Persia_Events.
#	title = Melva_Persia_Events..T
#	desc = Melva_Persia_Events..D
#	picture = GOOD_WITH_MONARCH_eventPicture
#
#	fire_only_once = yes
#
#	trigger = {
#		
#	}
#
#	mean_time_to_happen = {
#		days = 60
#	}
#
#	option = {
#		name = Melva_Persia_Events..OPT1
#
#	}
#}