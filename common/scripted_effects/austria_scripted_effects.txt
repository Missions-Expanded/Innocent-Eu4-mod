HAB_change_habsburg_glory = { #amount
	tooltip = {
		change_variable = {
			which = habsburg_glory
			value = $amount$
		}
	}
	
	hidden_effect = {
		change_variable = {
			which = habsburg_glory
			value = $amount$
		}
		HAB_determine_habsburg_glory_bonus = yes
	}
}

HAB_determine_habsburg_glory_bonus = {
	remove_country_modifier = HAB_habsburg_glory_21_40
	remove_country_modifier = HAB_habsburg_glory_41_60
	remove_country_modifier = HAB_habsburg_glory_61_80
	remove_country_modifier = HAB_habsburg_glory_81_100
	
	if = {
		limit = {
			check_variable = {
				which = habsburg_glory
				value = 81
			}
		}
		add_country_modifier = {
			name = HAB_habsburg_glory_81_100
			duration = -1
		}
	}
	else_if = {
		limit = {
			check_variable = {
				which = habsburg_glory
				value = 61
			}
		}
		add_country_modifier = {
			name = HAB_habsburg_glory_61_80
			duration = -1
		}
	}
	else_if = {
		limit = {
			check_variable = {
				which = habsburg_glory
				value = 41
			}
		}
		add_country_modifier = {
			name = HAB_habsburg_glory_41_60
			duration = -1
		}
	}
	else_if = {
		limit = {
			check_variable = {
				which = habsburg_glory
				value = 21
			}
		}
		add_country_modifier = {
			name = HAB_habsburg_glory_21_40
			duration = -1
		}
	}
	else = { }
}

HAB_balkanize_poland_into_hre_effect = {
	#Deal with Polish subjects - the ones in the german region are to be released and the rest inherited. Leave Lithuania (they are important to the end)
	
	set_country_flag = me_hab_balkanized_poland
	
	$Poland$ = {
		every_subject_country = {
			limit = {
				NOT = {
					tag = LIT
				}
			}
			if = {
				limit = {
					capital_scope = {
						OR = {
							region = north_german_region
							region = south_german_region
						}
					}
				}
				grant_independence = yes
			}
			else = {
				overlord = {
					inherit = PREV
				}
			}
		}
		
		every_owned_province = { #Get rid of those provinces.
			limit = {
				OR = {
					region = north_german_region
					region = south_german_region
				}
			}
			random_core_country = {
				limit = {
					NOT = { exists = yes }
				}
				save_event_target_as = HAB_temp
				PREV = {
					$Poland$ = {
						release = event_target:HAB_temp
					}
				}
			} #try again
			if = {
				limit = {
					owned_by = $Poland$
				}
				random_core_country = {
					limit = {
						exists = yes
						is_part_of_hre = yes
					}
					every_core_province = {
						limit = {
							owned_by = $poland$
						}
						cede_province = PREV
					}
				}
			}
			#omg try again
			if = {
				limit = {
					owned_by = $Poland$
				}
				random_core_country = {
					limit = {
						exists = yes
					}
					every_core_province = {
						limit = {
							owned_by = $poland$
						}
						cede_province = PREV
					}
				}
			}
			#at this point I give up
		}
	}
	
	$Poland$ = {
		every_owned_province = {
			set_province_flag = HAB_set_hre
		}
	}
	#Now let us handle individual provinces
	if = {
		limit = {
			NOT = {
				exists = KRA
			}
		}
		262 = {
			if = {
				limit = {
					owned_by = $Poland$
				}
				add_core = KRA
			}
		}
		$Poland$ = { 
			release = KRA
		}
	}
	else = {
		262 = {
			add_core = LRP
		}
	}
	
	sandomierz_area = {
		limit = {
			owned_by = $Poland$
		}
		add_core = LRP
	}
	malopolska_area = {
		limit = {
			owned_by = $Poland$
		}
		add_core = LRP
	}
	
	$Poland$ = {
		release = LRP
	}
	
	4526 = {
		if = {
			limit = {
				owned_by = $Poland$
			}
			add_core = GNE
		}
	}
	4533 = {
		if = {
			limit = {
				owned_by = $Poland$
			}
			add_core = GNE
		}
	}
	258 = {
		if = {
			limit = {
				owned_by = $Poland$
			}
			add_core = GNE
		}
	}
	1939 = {
		if = {
			limit = {
				owned_by = $Poland$
			}
			add_core = GNE
		}
	}
	$Poland$ = {
		release = GNE
	}
	
	wielkopolska_area = {
		limit = {
			owned_by = $Poland$
		}
		add_core = GRP
	}
	
	2997 = {
		if = {
			limit = {
				owned_by = $Poland$
			}
			add_core = GRP
		}
	}
	
	$Poland$ = {
		release = GRP
	}
	
	if = {
		limit = {
			NOT = { 
				exists = MAZ
			}
		}
		mazovia_area = {
			limit = {
				owned_by = $Poland$
			}
			add_core = MAZ
		}
		red_ruthenia_area = {
			remove_core = MAZ
		}
	}
	$Poland$ = {
		release = MAZ
	}
	
	kuyavia_area = {
		limit = {
			owned_by = $Poland$
		}
		add_core = KUY
	}
	
	$Poland$ = {
		release = KUY
	}
	
	if = {
		limit = {
			NOT = { exists = DNZ }
		}
		43 = {
			if = {
				limit = {
					owned_by = $Poland$
				}
				add_core = DNZ
				$Poland$ = {
					release = DNZ
				}
			}
		}
	}
	else = {
		43 = {
			if = {
				limit = {
					owned_by = $Poland$
				}
				add_core = WRM
			}
		}
	}
	
	1841 = {
		if = {
			limit = { 
				owned_by = $Poland$
			}
			add_core = WRM
		}
	}
	42 = {
		if = {
			limit = { 
				owned_by = $Poland$
			}
			add_core = WRM
		}
	}
	
	$Poland$ = {
		release = WRM 
	}
	
	east_prussia_area = {
		limit = {
			owned_by = $Poland$
		}
		add_core = PRU
	}
	$Poland$ = {
		release = PRU
	}
	
	$Poland$ = {
		every_owned_province = {
			clr_province_flag = HAB_set_hre
		}
	}
	
	every_province = {
		limit = {
			has_province_flag = HAB_set_hre
		}
		clr_province_flag = HAB_set_hre
		set_in_empire = yes
		add_core = LIT
	}
	
	$Poland$ = {
		save_event_target_as = HAB_target_pol
	}
	WRM = {
		change_religion = event_target:HAB_target_pol
		change_primary_culture = event_target:HAB_target_pol
	}
	GNE = {
		change_religion = event_target:HAB_target_pol
		change_primary_culture = event_target:HAB_target_pol
	}
	LRP = {
		change_religion =  event_target:HAB_target_pol
		change_primary_culture =  event_target:HAB_target_pol
	}
	GRP = {
		change_religion = event_target:HAB_target_pol
		change_primary_culture = event_target:HAB_target_pol
	}
	KUY = {
		change_religion = event_target:HAB_target_pol
		change_primary_culture = event_target:HAB_target_pol
	}
	DNZ = {
		change_religion = event_target:HAB_target_pol
		change_primary_culture = event_target:HAB_target_pol
	}
	PRU = {
		change_religion = event_target:HAB_target_pol
		change_primary_culture = event_target:HAB_target_pol
	}
	MAZ = {
		change_religion = event_target:HAB_target_pol
		change_primary_culture = event_target:HAB_target_pol
		define_ruler = {
			name = "Bartlomiej I 'Zlewikk'"
			dynasty = "Zalewski"
			change_adm = 3
			change_dip = 3
			change_mil = 3
			max_random_adm = 3
			max_random_dip = 3
			max_random_mil = 3
			age = 20
			claim = 100
		}
	}
	
	LIT = {
		inherit = $Poland$
		change_tag = PLC
	}
}

HAB_balkanize_france_into_hre_effect = {
	#copied from the above scripted effect
	
	
	set_global_flag = me_hab_balkanized_france
	
	$France$ = {
		every_subject_country = {
			if = {
				limit = {
					capital_scope = {
						OR = {
							region = north_german_region
							region = south_german_region
						}
					}
				}
				grant_independence = yes
			}
			else = {
				overlord = {
					inherit = PREV
				}
			}
		}
		
		every_owned_province = { #Get rid of those provinces.
			limit = {
				OR = {
					region = north_german_region
					region = south_german_region
				}
			}
			random_core_country = {
				limit = {
					NOT = { exists = yes }
				}
				save_event_target_as = HAB_temp
				PREV = {
					$France$ = {
						release = event_target:HAB_temp
					}
				}
			}
		}
	}
	
	$France$ = {
		every_owned_province = {
			set_province_flag = HAB_set_hre
		}
	}
	#Now let us handle individual provinces
	if = {
		limit = {
			NOT = {
				exists = PIC
			}
		}
		picardy_area = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = PIC
			}
		}
		$France$ = { 
			release = PIC
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = CHP
			}
		}
		picardy_area = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = CHP
			}
		}
		
		185 = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = CHP
			}
		}
		
		182 = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = CHP
			}
		}
		
		$France$ = { 
			release = CHP
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = NRM
			}
		}
		normandy_area = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = NRM
			}
		}
		
		$France$ = { 
			release = NRM
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = BRI
			}
		}
		brittany_area = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = BRI
			}
		}
		
		$France$ = { 
			release = BRI
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = PRO
			}
		}
		loire_area = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = PRO
			}
		}
		
		poitou_area = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = PRO
			}
		}
		
		provence_area = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = PRO
			}
		}
		
		$France$ = { 
			release = PRO
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = TOU
			}
		}
		languedoc_area = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = TOU
			}
		}
		
		$France$ = { 
			release = TOU
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = GUY
			}
		}
		guyenne_area = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = GUY
			}
		}
		
		pyrenees_area = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = GUY
			}
		}
		
		massif_central_area = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = GUY
			}
		}
		
		$France$ = { 
			release = GUY
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = DAU
			}
		}
		savoy_dauphine_area = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = DAU
			}
		}
		
		$France$ = { 
			release = DAU
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = ORL
			}
		}
		orleans_area = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = ORL
			}
		}
		
		$France$ = { 
			release = ORL
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = BUR
			}
		}
		west_burgundy_area = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = BUR
			}
		}
		bourgogne_area = {
			if = {
				limit = {
					owned_by = $France$
				}
				add_core = BUR
			}
		}
		
		$France$ = { 
			release = BUR
		}
	}
	
	
	$France$ = {
		every_owned_province = {
			clr_province_flag = HAB_set_hre
		}
	}
	
	every_owned_province = {
		set_in_empire = yes
	}
}

me_decrease_emperor_of_romans_level = {
	subtract_variable = {
		which = me_emperor_of_romans_level
		value = 1
	}
	if = {
		limit = {
			NOT = { check_variable = { which = me_emperor_of_romans_level value = 0 } }
		}
		set_variable = { which = me_emperor_of_romans_level value = 0 }
	}
	if = {
		limit = {
			check_variable = { which = me_emperor_of_romans_level value = 4 }
			NOT = { check_variable = { which = me_emperor_of_romans_level value = 5 } }
		}
		add_ruler_modifier = {
			name = me_sty_emperor_of_romans_1
			duration = -1
		}
	}
	else_if = {
		limit = {
			check_variable = { which = me_emperor_of_romans_level value = 3 }
			NOT = { check_variable = { which = me_emperor_of_romans_level value = 4 } }
		}
		add_ruler_modifier = {
			name = me_sty_emperor_of_romans_2
			duration = -1
		}
	}
	else_if = {
		limit = {
			check_variable = { which = me_emperor_of_romans_level value = 2 }
			NOT = { check_variable = { which = me_emperor_of_romans_level value = 3 } }
		}
		add_ruler_modifier = {
			name = me_sty_emperor_of_romans_3
			duration = -1
		}
	}
	else_if = {
		limit = {
			check_variable = { which = me_emperor_of_romans_level value = 1 }
			NOT = { check_variable = { which = me_emperor_of_romans_level value = 2 } }
		}
		add_ruler_modifier = {
			name = me_sty_emperor_of_romans_4
			duration = -1
		}
	}
	else_if = {
		limit = {
			check_variable = { which = me_emperor_of_romans_level value = 0 }
			NOT = { check_variable = { which = me_emperor_of_romans_level value = 1 } }
		}
		#Do absolutely nothing
	}
}

me_increase_emperor_of_romans_level = {
	change_variable = {
		which = me_emperor_of_romans_level
		value = 1
	}
	if = {
		limit = {
			check_variable = { which = me_emperor_of_romans_level value = 5 }
		}
		set_variable = { which = me_emperor_of_romans_level value = 4 }
	}
	if = {
		limit = {
			has_ruler_modifier = me_sty_emperor_of_romans_4
			NOT = { has_ruler_modifier = me_sty_emperor_of_romans }
		}
		remove_country_modifier = me_sty_emperor_of_romans_4
		add_ruler_modifier = {
			name = me_sty_emperor_of_romans_3
			duration = -1
		}
	}
	else_if = {
		limit = {
			has_ruler_modifier = me_sty_emperor_of_romans_3
			NOT = { has_ruler_modifier = me_sty_emperor_of_romans }
		}
		remove_country_modifier = me_sty_emperor_of_romans_3
		add_ruler_modifier = {
			name = me_sty_emperor_of_romans_2
			duration = -1
		}
	}
	else_if = {
		limit = {
			has_ruler_modifier = me_sty_emperor_of_romans_3
			NOT = { has_ruler_modifier = me_sty_emperor_of_romans }
		}
		remove_country_modifier = me_sty_emperor_of_romans_3
		add_ruler_modifier = {
			name = me_sty_emperor_of_romans_2
			duration = -1
		}
	}
	else_if = {
		limit = {
			has_ruler_modifier = me_sty_emperor_of_romans_2
			NOT = { has_ruler_modifier = me_sty_emperor_of_romans }
		}
		remove_country_modifier = me_sty_emperor_of_romans_2
		add_ruler_modifier = {
			name = me_sty_emperor_of_romans_1
			duration = -1
		}
	}
	else_if = {
		limit = {
			NOT = { has_ruler_modifier = me_sty_emperor_of_romans_1 }
			NOT = { has_ruler_modifier = me_sty_emperor_of_romans_2 }
			NOT = { has_ruler_modifier = me_sty_emperor_of_romans_3 }
			NOT = { has_ruler_modifier = me_sty_emperor_of_romans_4 }
			NOT = { has_ruler_modifier = me_sty_emperor_of_romans }
		}
		add_ruler_modifier = {
			name = me_sty_emperor_of_romans_4
			duration = -1
		}
	}
}