#########
#Made by claivin for Missions Expanded Mod
#########

RAM_missions_1 = {
	slot = 1
	generic = no
	ai = yes
	potential = {
		NOT = { tag = RUM }
		OR = {
			tag = RAM
			was_tag = RAM
		}
		NOT = { has_country_flag = ME_TUR_Change_Tree }
	}
	has_country_shield = yes

	RAM_allies = {
		icon = me_mission_ottomans_a_mamluk_buffer
		required_missions = { beylik_force_limit_mission }
		position = 2
		provinces_to_highlight = {
			OR = {
				owned_by = TUR
				owned_by = MAM
			}
			NOT = { owned_by = ROOT }
		}
		trigger = {
			is_at_war = no
			if = {
				limit = {
					exists = TUR
					exists = MAM
				}
				OR = {
					AND = {
						alliance_with = TUR
						marriage_with = TUR
						NOT = { alliance_with = MAM }
					}
					AND = {
						alliance_with = MAM
						marriage_with = MAM
						NOT = { alliance_with = TUR }
					}
					AND = {
						TUR = { has_been_insulted_by_root = yes }
						MAM = { has_been_insulted_by_root = yes }
					}
				}
			}
			else = {
				num_of_allies = 2
			}
		}
		effect = {
			custom_tooltip = ram_ally_tt
			hidden_effect = {
				if = {
					limit = {
						alliance_with = TUR
					}
					create_general = {
						tradition = 50
						add_siege = 2
					}
				}
				else_if = {
					limit = {
						alliance_with = MAM
					}
					add_country_modifier = {
						name = ram_manpower
						duration = 12775
					}
				}
				else_if = {
					limit = {
						AND = {
							TUR = { has_been_insulted_by_root = yes }
							MAM = { has_been_insulted_by_root = yes }
						}
					}
					add_country_modifier = {
						name = ram_home_defense
						duration = 9125
					}
				}
				else = {
					add_dip_power = 100
				}
			}
		}
	}
}

RAM_missions_5 = {
	slot = 5
	generic = no
	ai = yes
	potential = {
		NOT = { tag = RUM }
		OR = {
			tag = RAM
			was_tag = RAM
		}
		NOT = { has_country_flag = ME_TUR_Change_Tree }
	}
	has_country_shield = yes
	
	RAM_copts = {
		icon = me_ram_copt
		required_missions = { beylik_force_limit_mission }
		position = 2
		provinces_to_highlight = {
			OR = {
				province_id = 358
				province_id = 1227
				province_id = 2313
				province_id = 1234
				province_id = 419
			}
			NOT = { owned_by = ROOT }
		}
		trigger = {
			OR = { #coptic sites
				358 = {
					owned_by = ROOT
				}
				1227 = {
					owned_by = ROOT
				}
				2313 = {
					owned_by = ROOT
				}
				1234 = {
					owned_by = ROOT
				}
				419 = {
					owned_by = ROOT
				}
			}
			theologian = 1
		}
		effect = {
			country_event = {
				id = ME_Beylik_Events.10
			}
		}
	}
}

ME_Ramazan_incident_missions_1 = {
	slot = 1
	generic = no
	ai = yes
	potential = {
		tag = RAM
		has_country_flag = ME_TUR_Change_Tree
	}
	has_country_shield = yes

	RAM_Wing_Plucking = {
		icon = me_ram_copt
		position = 1
		trigger = {
			custom_trigger_tooltip = {
				tooltip = ME_RAM_Occupy_Provinces_tt
				OR = {
					num_of_owned_provinces_with = {
						value = 15
						owned_by = PLC
						controlled_by = TUR
					}
					num_of_owned_provinces_with = {
						value = 15
						owned_by = POL
						controlled_by = TUR
					}
				}
			}
		}
		effect = {
			if = {
				limit = {
					num_of_owned_provinces_with = {
						value = 15
						owned_by = PLC
						controlled_by = TUR
					}
				}
				PLC = {
					add_country_modifier = {
						name = ME_TUR_Crippled_Horse_Supply
						duration = -1
					}	
				}
			}
			else = {
				POL = {
					add_country_modifier = {
						name = ME_TUR_Crippled_Horse_Supply
						duration = -1
					}	
				}
			}
		}
	}
}

ME_Ramazan_incident_missions_2 = {
	slot = 2
	generic = no
	ai = yes
	potential = {
		tag = RAM
		has_country_flag = ME_TUR_Change_Tree
	}
	has_country_shield = yes

	RAM_Time_Need = {
		icon = me_ram_copt
		position = 1
		trigger = {
			if = {
				limit = {
					exists = SPA
				}
				SPA = {
					current_war_losses = { 
						who_with = TUR
						type = infantry
						cause = battle
						amount = 60
					}
				}
				SPA = {
					current_war_losses = { 
						who_with = TUR
						type = artillery
						cause = battle
						amount = 20
					}
				}
			}
			else_if = {
				limit = {
					NOT = { exists = SPA }
					exists = CAS
				}
				CAS = {
					current_war_losses = { 
						who_with = TUR
						type = infantry
						cause = battle
						amount = 60
					}
				}
				CAS = {
					current_war_losses = { 
						who_with = TUR
						type = artillery
						cause = battle
						amount = 20
					}
				}
			}
			else_if = {
				limit = {
					NOT = { exists = SPA }
					NOT = { exists = CAS }
					exists = ARA
				}
				ARA = {
					current_war_losses = { 
						who_with = TUR
						type = infantry
						cause = battle
						amount = 60
					}
				}
				ARA = {
					current_war_losses = { 
						who_with = TUR
						type = artillery
						cause = battle
						amount = 20
					}
				}
			}
			else_if = {
				limit = {
					NOT = { exists = SPA }
					NOT = { exists = CAS }
					NOT = { exists = ARA }
					exists = POR
				}
				POR = {
					current_war_losses = { 
						who_with = TUR
						type = infantry
						cause = battle
						amount = 60
					}
				}
				POR = {
					current_war_losses = { 
						who_with = TUR
						type = artillery
						cause = battle
						amount = 20
					}
				}
			}
			else_if = {
				limit = {
					NOT = { exists = SPA }
					NOT = { exists = CAS }
					NOT = { exists = ARA }
					NOT = { exists = POR }
				}
				always = yes
			}
		}
		effect = {
			if = {
				limit = {
					TUR = {
						is_in_war = {
							attacker_leader = TUR
							casus_belli = ME_Ottomans_Roman_Facade_CB
							participants = SPA
						}
					}
				}
				TUR = { white_peace = SPA }
			}
			else_if = {
				limit = {
					TUR = {
						is_in_war = {
							attacker_leader = TUR
							casus_belli = ME_Ottomans_Roman_Facade_CB
							participants = CAS
						}
					}
				}
				TUR = { white_peace = CAS }
			}
			else_if = {
				limit = {
					TUR = {
						is_in_war = {
							attacker_leader = TUR
							casus_belli = ME_Ottomans_Roman_Facade_CB
							participants = ARA
						}
					}
				}
				TUR = { white_peace = ARA }
			}
			else_if = {
				limit = {
					TUR = {
						is_in_war = {
							attacker_leader = TUR
							casus_belli = ME_Ottomans_Roman_Facade_CB
							participants = POR
						}
					}
				}
				TUR = { white_peace = POR }
			}
			else = { add_prestige = 1 }
		}
	}

	RAM_Pride_Humiliation = {
		icon = me_ram_copt
		position = 2
		required_missions = { 
			RAM_Time_Need 
			RAM_Time_Need
		}
		trigger = {
			if = {
				limit = {
					exists = PLC
					TUR = {
						is_in_war = {
							attacker_leader = TUR
							casus_belli = ME_Ottomans_Roman_Facade_CB
							participants = PLC
						}
					}
				}
			}
			PLC = {
				current_war_losses = { 
					who_with = TUR
					type = cavalry
					cause = battle
					amount = 30
				}
			}
			else_if = {
				limit = {
					NOT = { exists = PLC }
					exists = POL
					TUR = {
						is_in_war = {
							attacker_leader = TUR
							casus_belli = ME_Ottomans_Roman_Facade_CB
							participants = POL
						}
					}
				}
				POL = {
					current_war_losses = { 
						who_with = TUR
						type = cavalry
						cause = battle
						amount = 30
					}
				}
			}
			else = { always = yes }
		}
		effect = {
			if = {
				limit = {
					TUR = {
						is_in_war = {
							attacker_leader = TUR
							casus_belli = ME_Ottomans_Roman_Facade_CB
							participants = PLC
						}
					}
				}
				PLC = { white_peace = TUR }
			}
			else_if = {
				limit = {
					TUR = {
						is_in_war = {
							attacker_leader = TUR
							casus_belli = ME_Ottomans_Roman_Facade_CB
							participants = POL
						}
					}
				}
				POL = { white_peace = TUR }
			}
			else = { add_prestige = 10 }
		}
	}
}

ME_Ramazan_incident_missions_3 = {
	slot = 3
	generic = no
	ai = yes
	potential = {
		tag = RAM
		has_country_flag = ME_TUR_Change_Tree
	}
	has_country_shield = yes

	RAM_Show_Strength = {
		icon = me_ram_copt
		position = 3
		required_missions = { RAM_Pride_Humiliation }
		provinces_to_highlight = {
			is_capital = yes
			owner = { is_emperor = yes }
		}
		trigger = {
			any_province = {
				owned_by = emperor
				is_capital = yes
				controlled_by = TUR
			}
			emperor = {
				NOT = { army_size_percentage = 0.1 }
			}
			num_of_cities = 1
		}
		effect = {
			if = {
				limit = {
					any_province = {
						owned_by = emperor
						is_capital = yes
						controlled_by = TUR
					}
					emperor = {
						NOT = { army_size_percentage = 0.1 }
					}
					num_of_cities = 1
				}
				TUR = {
					add_prestige = 25
					add_adm_power = 100
					add_dip_power = 100
					add_mil_power = 100
				}
			}
			TUR = { inherit = RAM }
			remove_country_modifier = ME_TUR_Crippled_Horse_Supply
			remove_country_modifier = ME_TUR_Ottoman_Storm
			remove_country_modifier = ME_TUR_Iminent_Surrender
			TUR = { set_country_flag = ME_TUR_Roman_Facade_End }
		}
	}
}

ME_Ramazan_incident_missions_4 = {
	slot = 4
	generic = no
	ai = yes
	potential = {
		tag = RAM
		has_country_flag = ME_TUR_Change_Tree
	}
	has_country_shield = yes

	RAM_Preparing_Forces = {
		icon = me_ram_copt
		position = 1
		trigger = {
			TUR = {
				OR = {
					army_size_percentage = 0.1
					army_size = 100
				}
			}
		}
		effect = {
			TUR = {
				add_country_modifier = {
					name = ME_TUR_Ottoman_Storm
					duration = -1
				}
			}
		}
	}

	RAM_Fishing_Off = {
		icon = me_ram_copt
		position = 2
		required_missions = { RAM_Preparing_Forces}
		trigger = {
			if = {
				limit = {
				  	emperor = {
						num_of_owned_provinces_with = {
							value = 25
							is_part_of_hre = yes
						}
					}
				}
				emperor = {
					num_of_owned_provinces_with = {
						value = 15
						is_part_of_hre = yes
						controlled_by = TUR
					}
				}
			}
			else_if = {
				limit = {
					emperor = {
						num_of_owned_provinces_with = {
							value = 14
					  		is_part_of_hre = yes
						}
					}
				}
				emperor = {
					num_of_owned_provinces_with = {
						value = 10
						is_part_of_hre = yes
						controlled_by = TUR
					}
				}
			}
			else_if = {
				limit = {
				  	emperor = {
						num_of_owned_provinces_with = {
					 		value = 5
							is_part_of_hre = yes
						}
					}
				}
				emperor = {
					num_of_owned_provinces_with = {
						value = 5
						is_part_of_hre = yes
						controlled_by = TUR
					}
				}
			}
			else_if = {
				limit = {
					NOT = {
						emperor = {
							num_of_owned_provinces_with = {
								value = 5
								is_part_of_hre = yes
							}
						}
					}
				}
				emperor = {
					num_of_owned_provinces_with = {
						value = 1
						is_part_of_hre = yes
						controlled_by = TUR
					}
				}
			}
			else = { always = yes }
		}
		effect = {
			if = {
				limit = {
					OR = {
						emperor = {
							num_of_owned_provinces_with = {
								value = 15
								is_part_of_hre = yes
								controlled_by = ROOT
							}
						}
						emperor = {
							num_of_owned_provinces_with = {
								value = 10
								is_part_of_hre = yes
								controlled_by = ROOT
							}
						}
						emperor = {
							num_of_owned_provinces_with = {
								value = 5
								is_part_of_hre = yes
								controlled_by = ROOT
							}
						}
						emperor = {
							num_of_owned_provinces_with = {
								value = 1
								is_part_of_hre = yes
								controlled_by = TUR
							}
						}
					}	
				}
				emperor = {
					add_country_modifier = {
						name = ME_TUR_Iminent_Surrender
						duration = -1
					}
				}
			}
			else = { add_prestige = 10 }
		}
	}
}

ME_Ramazan_incident_missions_5 = {
	slot = 5
	generic = no
	ai = yes
	potential = {
		tag = RAM
		has_country_flag = ME_TUR_Change_Tree
	}
	has_country_shield = yes

	RAM_Council_Fool = {
		icon = me_ram_copt
		position = 1
		provinces_to_highlight = {
			AND = {
				owner = { is_elector = yes }
				is_capital = yes
				is_part_of_hre = yes
			}
		}
		trigger = {
			all_elector = {
				capital_scope = {
					controlled_by = TUR
				}
			}
		}
		effect = {
			every_elector = {
				limit = {
					is_in_war = {
						attacker_leader = TUR
						casus_belli = ME_Ottomans_Roman_Facade_CB
					}
				}
				white_peace = TUR
			}
		}
	}
}
