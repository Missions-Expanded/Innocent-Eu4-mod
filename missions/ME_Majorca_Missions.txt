majorca_missions_1 = {
	slot = 1
	generic = no
	ai = yes
	potential = {
		tag = MJO
	}
	has_country_shield = yes

	mjo_principality_valencia = {
		icon = me_mission_persia_audience_with_shah
		required_missions = {
			mjo_privative_kingdom
		}
		position = 2
		provinces_to_highlight = {
			area = valencia_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			valencia_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			OR = {
				NOT = { exists = VAL }
				overlord_of = VAL
				iberia_region = {
					NOT = { owned_by = VAL }
				}
			}
		}
		effect = {
			add_country_modifier = {
				name = cat_emirate_balansiyya
				duration = 9125
			}
		}
	}

	mjo_lonja_de_la_seda = {
		icon = mission_valencian_silk
		required_missions = {
			mjo_true_aragonese_heir
		}
		position = 4
		provinces_to_highlight = {
			province_id = 220
			OR = {
				NOT = { owned_by = ROOT }
				NOT = { has_trade_building_trigger = yes }
				NOT = { num_of_times_improved = 3 }
			}
		}
		trigger = {
			220 = {
				owned_by = ROOT
				has_trade_building_trigger = yes
				num_of_times_improved = 3
			}
		}
		effect = {
			220 = {
				if = {
					limit = {
						has_dlc = "Leviathan"
						is_expanded_mod_active = { mod = great_monuments }
						NOT = {
							has_great_project = {
								type = gme_lonja_seda
								tier = 3
							}
						}
					}
					add_great_project_tier = {
						type = gme_lonja_seda
						tier = 1
					}
				}
				else = {
					add_permanent_province_modifier = {
						name = mjo_lonja_seda
						duration = -1
					}
				}
			}
		}
	}

	mjo_rivaling_arsenal = {
		icon = me_mission_persia_audience_with_shah
		required_missions = { }
		position = 6
		provinces_to_highlight = { }
		trigger = {
			naval_forcelimit = 1
			num_of_galley = 10
			sailors_percentage = 0.40
		}
		effect = {
			
		}
	}
}

majorca_missions_2 = {
	slot = 2
	generic = no
	ai = yes
	potential = {
		tag = MJO
	}
	has_country_shield = yes

	mjo_crown_aragon = {
		icon = king_of_aragon
		required_missions = {
			mjo_privative_kingdom
		}
		position = 2
		provinces_to_highlight = {
			area = aragon_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			aragon_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			OR = {
				NOT = { exists = ARA }
				overlord_of = ARA
				iberia_region = {
					NOT = { owned_by = ARA }
				}
			}
		}
		effect = {
			add_country_modifier = {
				name = mjo_crown_aragon_modifier
				duration = 9125
			}
		}
	}

	mjo_true_aragonese_heir = {
		icon = mission_empire
		required_missions = {
			mjo_principality_valencia
			mjo_crown_aragon
		}
		position = 3
		provinces_to_highlight = {
			OR = {
				area = aragon_area
				area = valencia_area
				area = catalonia_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			aragon_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			valencia_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			catalonia_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			custom_trigger_tooltip = {
				tooltip = VAL_IBERIA_NOT_BIGGER_TT
				NOT = {
					any_country = {
						capital_scope = {
							region = iberia_region
						}
						OR = {
							total_development = ROOT
							army_size = ROOT
						}
					}
				}
			}
		}
		effect = {
			if = {
				limit = {
					tag = CAT
				}
				add_country_modifier = {
					name = mjo_consell_de_cent
					desc = me_until_tag_switch_tt
					duration = -1
				}
			}
			else = {
				add_country_modifier = {
					name = mjo_consell_de_cent_weak
					duration = 7300
				}
			}
			iberia_region = {
				limit = {
					NOT = { owned_by = ROOT }
					NOT = { is_core = ROOT }
					NOT = { is_empty = yes }
					NOT = { is_wasteland = yes }
				}
				add_permanent_claim = ROOT
			}
		}
	}

	mjo_llotja_de_mar = {
		icon = mission_guilds_of_barcelona
		required_missions = {
			mjo_true_aragonese_heir
		}
		position = 4
		provinces_to_highlight = {
			province_id = 213
			OR = {
				NOT = { owned_by = ROOT }
				NOT = { has_trade_building_trigger = yes }
				NOT = { num_of_times_improved = 3 }
			}
		}
		trigger = {
			213 = {
				owned_by = ROOT
				has_trade_building_trigger = yes
				num_of_times_improved = 3
			}
		}
		effect = {
			213 = {
				add_or_upgrade_trade_building = yes
				create_or_add_center_of_trade_level = { level = 1 }
			}
		}
	}

	mjo_silk_dominance = {
		icon = mission_industria_sedera
		required_missions = {
			mjo_lonja_de_la_seda
			mjo_llotja_de_mar
			mjo_iberian_silk
		}
		position = 5
		provinces_to_highlight = { }
		trigger = {
			development_in_provinces = {
				value = 100
				OR = {
					trade_goods = silk
					trade_goods = cloth
				}
			}
			OR = {
				trading_bonus = {
					trade_goods = cloth
					value = yes
				}
				production_leader = {
					trade_goods = cloth
				}
				production_leader = {
					trade_goods = silk
				}
				trading_bonus = {
					trade_goods = silk
					value = yes
				}
			}
		}
		effect = {
			if = {
				limit = {
					tag = CAT
				}
				add_country_modifier = {
					name = mjo_remenca_de_los_pagesos
					desc = me_until_tag_switch_tt
					duration = -1
				}
			}
			else = {
				add_country_modifier = {
					name = mjo_remenca_de_los_pagesos_weak
					duration = 7300
				}
			}
		}
	}

	mjo_palau_reial_major = {
		icon = me_mission_persia_audience_with_shah
		required_missions = {
			mjo_principat_catalunya
		}
		position = 7
		provinces_to_highlight = {
			province_id = 231
			OR = {
				NOT = { owned_by = ROOT }
				NOT = { has_tax_building_trigger = yes }
				NOT = { num_of_buildings_in_province = 3 }
			}
			NOT = { base_tax = 10 }
			NOT = { base_production = 10 }
		}
		trigger = {
			231 = {
				owned_by = ROOT
				has_tax_building_trigger = yes
				num_of_buildings_in_province = 3
				OR = {
					base_tax = 10
					base_production = 10
				}
			}
		}
		effect = {
			add_adm_power = 100
			add_dip_power = 100
			add_mil_power = 100
			if = {
				limit = {
					has_dlc = "Mandate of Heaven"
				}
				add_splendor = 100
				231 = { add_prosperity = 50 }
			}
		}
	}

	mjo_estudi_general_medicina_arts = {
		icon = me_mission_persia_audience_with_shah
		required_missions = {
			mjo_palau_reial_major
		}
		position = 7
		provinces_to_highlight = {
			province_id = 231
			OR = {
				NOT = { owned_by = ROOT }
				NOT = { development = 36 }
			}
			NOT = { province_has_center_of_trade_of_level = 3 }
			num_free_building_slots = 0
		}
		trigger = {
			231 = {
				owned_by = ROOT
				development = 36
				OR = {
					province_has_center_of_trade_of_level = 3
					NOT = { num_free_building_slots = 1 }
				}
			}
		}
		effect = {
			213 = {
				add_or_upgrade_university_building = yes
				add_permanent_province_modifier = {
					name = mjo_estudi_general_barcelona
					duration = -1
				}
			}
		}
	}
}

majorca_missions_3 = {
	slot = 3
	generic = no
	ai = yes
	potential = {
		tag = MJO
	}
	has_country_shield = yes

	mjo_privative_kingdom = {
		icon = mission_raid_christian_trade
		required_missions = { }
		position = 1
		provinces_to_highlight = {
			area = baleares_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			baleares_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			OR = {
				NOT = { exists = MJO }
				overlord_of = MJO
				iberia_region = {
					NOT = { owned_by = MJO }
				}
			}
		}
		effect = {
			add_country_modifier = {
				name = mjo_haven_slave_trade
				duration = 9125
			}
		}
	}

	mjo_autonomous_region_catalonia = {
		icon = me_mission_persia_audience_with_shah
		required_missions = {
			mjo_privative_kingdom
		}
		position = 2
		provinces_to_highlight = {
			area = catalonia_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			catalonia_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			OR = {
				NOT = { exists = CAT }
				overlord_of = CAT
				iberia_region = {
					NOT = { owned_by = CAT }
				}
			}
		}
		effect = {
			add_country_modifier = {
				name = mjo_crown_catalonia
				duration = 9125
			}
		}
	}

	mjo_almogavars = {
		icon = me_mission_persia_audience_with_shah
		required_missions = {
			mjo_true_aragonese_heir
			mjo_privative_kingdom
		}
		position = 4
		provinces_to_highlight = { }
		trigger = {
			NOT = { average_autonomy = 30 }
		}
		effect = {
			if = {
				limit = {
					tag = CAT
				}
				add_country_modifier = {
					name = mjo_catalan_company
					desc = me_until_tag_switch_tt
					duration = -1
				}
			}
			else = {
				add_country_modifier = {
					name = mjo_catalan_company_weak
					duration = 7300
				}
			}
		}
	}

	mjo_principat_catalunya = {
		icon = me_mission_persia_audience_with_shah
		required_missions = { }
		position = 6
		provinces_to_highlight = {
			area = catalonia_area
			NOT = { owned_by = ROOT }
		}
		trigger = {
			OR = {
				ADM = 6
				has_adm_advisor_3 = yes
			}
			if = {
				limit = {
					has_dlc = "Rule Britannia"
				}
				OR = {
					is_ahead_of_time_in_specific_tech = { type = adm }
					innovativeness = 50
				}
			}
			OR = {
				monthly_income = 25
				share_of_starting_income = 10
			}
			catalonia_area = {
				type = all
				owned_by = ROOT
			}
		}
		effect = {
			catalonia_area = {
				add_permanent_province_modifier = {
					name = mjo_sentencia_arbitral
					duration = -1
				}
			}
		}
	}

	mjo_war_paesants = {
		icon = me_mission_persia_audience_with_shah
		required_missions = {
			mjo_principat_catalunya
		}
		position = 7
		provinces_to_highlight = {
			area = catalonia_area
			NOT = { owned_by = ROOT }
		}
		trigger = {
			OR = {
				ADM = 6
				has_dip_advisor_3 = yes
			}
			is_ahead_of_time_in_specific_tech = { type = dip }
			catalonia_area = {
				type = all
				owned_by = ROOT
			}
		}
		effect = {
			if = {
				limit = {
					tag = CAT
				}
				add_country_modifier = {
					name = mjo_generalitat_catalunya_modifier
					desc = me_until_tag_switch_tt
					duration = -1
				}
			}
			else = {
				add_country_modifier = {
					name = mjo_generalitat_catalunya_weak
					duration = 7300
				}
			}
			catalonia_area = {
				add_permanent_province_modifier = {
					name = mjo_remensa
					duration = -1
				}
			}
		}
	}

	mjo_generalitat_catalunya = {
		icon = me_mission_persia_audience_with_shah
		required_missions = {
			mjo_palau_reial_major
		}
		position = 8
		provinces_to_highlight = {
			province_id = 213
			NOT = { owned_by = ROOT }
		}
		trigger = {
			ME_has_reform_on_level = { level = 3 }
			NOT = {
				has_global_modifier_value = {
					which = global_unrest
					value = -0.05
				}
			}
			213 = {
				owned_by = ROOT
				num_of_times_improved = 6
			}
		}
		effect = {
			if = {
				limit = {
					tag = CAT
				}
				add_country_modifier = {
					name = mjo_catalan_constitution
					desc = me_until_tag_switch_tt
					duration = -1
				}
			}
			else = {
				add_country_modifier = {
					name = mjo_catalan_constitution_weak
					duration = 7300
				}
			}
			213 = {
				add_or_upgrade_courthouse_building = yes
			}
		}
	}
}

majorca_missions_4 = {
	slot = 4
	generic = no
	ai = yes
	potential = {
		tag = MJO
	}
	has_country_shield = yes

	mjo_valencian_galleys = {
		icon = mission_galleys_in_port
		required_missions = {
			mjo_privative_kingdom
			mjo_nation_sailors
		}
		position = 2
		provinces_to_highlight = { }
		trigger = {
			num_of_galley = 12
		}
		effect = {
			create_admiral = {
				tradition = 75
			}
			baleares_area = {
				limit = {
					NOT = { owned_by = ROOT }
					NOT = { is_core = ROOT }
					NOT = { is_empty = yes }
					NOT = { is_wasteland = yes }
				}
				add_permanent_claim = ROOT
			}
		}
	}

	mjo_piracy_protection = {
		icon = me_mission_persia_audience_with_shah
		required_missions = {
			mjo_privative_kingdom
			mjo_valencian_galleys
		}
		position = 4
		provinces_to_highlight = { }
		trigger = {
			1295 = {
				custom_trigger_tooltip = {
					tooltip = ME_5_TRADE_SHARE_NAVY_ROOT
					NOT = {
						any_country = {
							NOT = { tag = ROOT }
							PREV = {
								trade_share = {
									share = 10
									country = PREV 
								}
							}
							navy_size = ROOT
						}
					}
				}
			}
		}
		effect = {
			341 = {
				custom_tooltip = COUNTRY_PERMANENT_CLAIM_TRADE_PORT_NODE
				hidden_effect = {
					every_trade_node_member_province = {
						limit = {
							has_port = yes
							NOT = { owned_by = ROOT }
							NOT = { is_core = ROOT }
							NOT = { is_empty = yes }
							NOT = { is_wasteland = yes }
						}
						add_permanent_claim = ROOT
					}
				}
			}
		}
	}

	mjo_fortress_piracy = {
		icon = mission_arabian_fort
		required_missions = {
			mjo_piracy_protection
		}
		position = 6
		provinces_to_highlight = {
			OR = {
				province_id = 341
				province_id = 339
			}
			OR = {
				NOT = { country_or_non_sovereign_subject_holds = ROOT }
				devastation = 1
			}
		}
		trigger = {
			341 = {
				country_or_non_sovereign_subject_holds = ROOT
				NOT = { devastation = 1 }
			}
			339 = {
				country_or_non_sovereign_subject_holds = ROOT
				NOT = { devastation = 1 }
			}
		}
		effect = {
			if = {
				limit = { religion = catholic }
				add_papal_influence = 10
			}
			add_country_modifier = {
				name = sar_piracy_defeaten
				duration = 9125
			}
			341 = {
				add_province_modifier = {
					name = sar_purification_land
					duration = 7300
				}
			}
			339 = {
				add_province_modifier = {
					name = sar_purification_land
					duration = 7300
				}
			}
		}
	}
}

majorca_missions_5 = {
	slot = 5
	generic = no
	ai = yes
	potential = {
		tag = MJO

	}
	has_country_shield = yes

	mjo_nation_sailors = {
		icon = overshadow_venice
		required_missions = { }
		position = 1
		provinces_to_highlight = {
			has_port = yes
			owned_by = ROOT
			NOT = { num_of_times_improved = 2 }
		}
		trigger = {
			num_of_owned_provinces_with = {
				value = 2
				has_port = yes
				num_of_times_improved = 2
			}
		}
		effect = {
			add_yearly_sailors = 10
			add_country_modifier = {
				name = mjo_namjo_propaganda
				duration = 7300
			}
			random_owned_province = {
				limit = {
					has_port = yes
					num_of_times_improved = 2
					NOT = { has_province_flag = me_upgraded }
				}
				set_province_flag = me_upgraded
				add_or_upgrade_shipyard_building = yes
			}
			random_owned_province = {
				limit = {
					has_port = yes
					num_of_times_improved = 2
					NOT = { has_province_flag = me_upgraded }
				}
				set_province_flag = me_upgraded
				add_or_upgrade_shipyard_building = yes
			}
		}
	}

	mjo_overshadow_genoa = {
		icon = mission_dominate_genoa
		required_missions = {
			mjo_nation_sailors
		}
		position = 3
		provinces_to_highlight = { }
		trigger = {
			if = {
				limit = {
					exists = GEN
				}
				GEN = {
					NOT = {
						navy_size = ROOT
					}
				}
			}
			else = {
				1298 = {
					custom_trigger_tooltip = {
						tooltip = ME_5_TRADE_SHARE_NAVY_ROOT
						NOT = {
							any_country = {
								NOT = { tag = ROOT }
								PREV = {
									trade_share = {
										share = 5
										country = PREV 
									}
								}
								navy_size = ROOT
							}
						}
					}
				}
			}
		}
		effect = {
			1298 = {
				custom_tooltip = COUNTRY_PERMANENT_CLAIM_TRADE_PORT_NODE
				hidden_effect = {
					every_trade_node_member_province = {
						limit = {
							has_port = yes
							NOT = { owned_by = ROOT }
							NOT = { is_core = ROOT }
							NOT = { is_empty = yes }
							NOT = { is_wasteland = yes }
						}
						add_permanent_claim = ROOT
					}
				}
			}
			1295 = {
				custom_tooltip = COUNTRY_PERMANENT_CLAIM_TRADE_PORT_NODE
				hidden_effect = {
					every_trade_node_member_province = {
						limit = {
							has_port = yes
							NOT = { owned_by = ROOT }
							NOT = { is_core = ROOT }
							NOT = { is_empty = yes }
							NOT = { is_wasteland = yes }
						}
						add_permanent_claim = ROOT
					}
				}
			}
		}
	}

	mjo_purely_for_commerce = {
		icon = end_genoese_competition
		required_missions = {
			mjo_overshadow_genoa
		}
		position = 5
		provinces_to_highlight = {
			province_id = 101
			NOT = { owned_by = ROOT }
		}
		trigger = {
			owns = 101
		}
		effect = {
			101 = {
				create_or_add_center_of_trade_level = { level = 1 }
			}
			1298 = {
				add_trade_node_income = 10
			}
		}
	}

	mjo_union_western_mediterranean = {
		icon = overshadow_venice
		required_missions = {
			mjo_fortress_piracy
			mjo_purely_for_commerce
		}
		position = 7
		provinces_to_highlight = {
			OR = {
				any_trade_node_member_province = {
					OR = {
						province_id = 341
						province_id = 1295
						province_id = 1298
					}
				}
				area = lower_andalucia_area
				area = upper_andalucia_area
				area = toledo_area
				area = northern_morocco_area
				area = algiers_area
				area = barbary_coast_area
			}
			has_port = yes
			NOT = { owned_by = ROOT }
		}
		trigger = {
			custom_trigger_tooltip = {
				tooltip = mjo_UNION_WESTERN_MEDITRREANNEAN_TT
				341 = {
					all_trade_node_member_province = {
						OR = {
							has_port = no
							owned_by = ROOT
						}
					}
				}
				1295 = {
					all_trade_node_member_province = {
						OR = {
							has_port = no
							owned_by = ROOT
						}
					}
				}
				1298 = {
					all_trade_node_member_province = {
						OR = {
							has_port = no
							owned_by = ROOT
						}
					}
				}
				lower_andalucia_area = {
					type = all
					OR = {
						owned_by = ROOT
						NOT = { has_port = yes }
					}
				}
				upper_andalucia_area = {
					type = all
					OR = {
						owned_by = ROOT
						NOT = { has_port = yes }
					}
				}
				toledo_area = {
					type = all
					OR = {
						owned_by = ROOT
						NOT = { has_port = yes }
					}
				}
				northern_morocco_area = {
					type = all
					OR = {
						owned_by = ROOT
						NOT = { has_port = yes }
					}
				}
				algiers_area = {
					type = all
					OR = {
						owned_by = ROOT
						NOT = { has_port = yes }
					}
				}
				barbary_coast_area = {
					type = all
					OR = {
						owned_by = ROOT
						NOT = { has_port = yes }
					}
				}
			}
		}
		effect = {
			if = {
				limit = {
					tag = VAL
				}
				add_country_modifier = {
					name = mjo_valencian_oranges
					desc = me_until_tag_switch_tt
					duration = -1
				}
			}
			else = {
				add_country_modifier = {
					name = mjo_valencian_oranges_weak
					duration = 7300
				}
			}
		}
	}
}